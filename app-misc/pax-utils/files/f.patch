From 4941a742dcd35d80d16fc96906cd022e03a3799b Mon Sep 17 00:00:00 2001
From: Mike Frysinger <vapier@gentoo.org>
Date: Thu, 3 Mar 2016 16:10:26 -0500
Subject: [PATCH] security: whitelist readlinkat

Newer arches omit readlink entirely (like aarch64).

Reported-by: Steev Klimaszewski <steev@gentoo.org>
---
 security.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/security.c b/security.c
index b635ccf..8019860 100644
--- a/security.c
+++ b/security.c
@@ -136,6 +136,7 @@ static void pax_seccomp_init(bool allow_forking)
 
 		/* Syscalls listed because of sandbox.  */
 		SCMP_SYS(readlink),
+		SCMP_SYS(readlinkat),
 		SCMP_SYS(getcwd),
 
 		/* Syscalls listed because of fakeroot.  */
-- 
2.6.2

